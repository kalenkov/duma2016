# duma2016
Скрипт для построения схемы одномандатных округов на выборах в Госдуму в 2016 году

# Необходимые инструменты и данные

* perl, make, wget, ogr2ogr

* Для обрезки по береговой линии дополнительно нужна утилита osmfilter и shape-файл с береговой линией с сайта http://openstreetmapdata.com/data/land-polygons

## Использование

### Минимальная инструкция
* Поместить файлы из репозитория в отдельную директорию
* Распаковать туда shape-файлы с береговыми границами с сайта http://openstreetmapdata.com/data/land-polygons
* Выполнить команды
```
cat id.txt | ./id2Makefile.pl > Makefile
cat Makefile.fix >> Makefile
make fix_okrug_69
make fix_okrug_70
make fix_okrug_222
make fix_okrug_223
make okrug_all
make okrug_all_land
```

На многоядерных и/или многопроцессорных системах время сборки можно сильно уменьшить, если использовать многопоточную сборку `make -j N`, где `N` - число потоков. Построение береговой линии России и последующая обрезка может занять много времени (час или дольше, в зависимости от мощности компьютера).

Результат будет содержаться в файлах `okrug_all_diss.*` `okrug_all_diss_land.*`

### Создание Makefile

```
cat id.txt | ./id2Makefile.pl > Makefile
```

### Сборка схемы округов

* Создать shape-файл округа `NNN`
```
make okrug_NNN.shp
```

* Создать shape-файл округа `NNN` одним полигоном
```
make okrug_NNN_diss.shp
```

* Собрать shape-файл с береговой границей России (требуется предварительно загрузить Land polygons с сайта http://openstreetmapdata.com/data/land-polygons)
```
make russia_land_diss.shp
```

* Удалить все файлы, созданные при построении shape-файла округа `NNN` (скачанные `osm` файлы не удаляются)
```
make clean_NNN
```

* Удалить все файлы, созданные при построении shape-файла округа `NNN` вместе  со скачанными `osm` файлами
```
make clean_all_NNN
```

* Удалить все файлы, созданные при построении shape-файлов всех округов (скачанные `osm` файлы не удаляются и не удаляются shape-файлы с границей России)
```
make clean_okrug
```

* Удалить все файлы, созданные при построении shape-файлов всех округов вместе со скачанными `osm` файлами (shape-файлы с границей России не удаляются)
```
make clean_all_okrug
```

* Удалить все файлы, созданные при построении shape-файлов всех округов и все файлы, созданные при построении shape-файла береговой границы России (скачанные `osm` файлы не удаляются)
```
make clean
```

* Удалить все файлы, созданные при построении shape-файлов всех округов и все файлы, созданные при построении shape-файла береговой границы России вместе со скачанными `osm` файлами
```
make clean_all
```

* Удалить все файлы, созданные при построении shape-файла береговой границы России (скачанные `osm` файлы не удаляются)
```
make clean_russia
```

* Удалить все файлы, созданные при построении shape-файла береговой границы России вместе  со скачанными `osm` файлами
```
make clean_all_russia
```
